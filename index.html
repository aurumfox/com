<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aurum Fox Portal: Web3 & Multimedia Ecosystem on Solana</title>
    
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self' https://terminal.jup.ag https://api.mainnet-beta.solana.com;
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js-de.sentry-cdn.com https://www.gstatic.com https://cdn.jup.ag https://terminal.jup.ag https://unpkg.com https://kit.fontawesome.com; 
        connect-src 'self' wss://api.mainnet-beta.solana.com https://o4505059231873024.ingest.sentry.io https://firestore.googleapis.com https://auth.firebase.com https://api.jupiter.ag; 
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
        font-src 'self' https://fonts.gstatic.com; 
        img-src 'self' https://via.placeholder.com data: https:; 
        frame-src https://terminal.jup.ag https://birdeye.so;
        upgrade-insecure-requests;
    ">

    <script src="https://unpkg.com/@solana/web3.js@1.91.7/lib/index.iife.js"></script>
    <script src="https://unpkg.com/@solana/wallet-adapter-base@0.9.23/dist/index.iife.js"></script>
    <script src="https://unpkg.com/@solana/wallet-adapter-phantom@0.9.23/dist/index.iife.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
        body { font-family: 'Poppins', sans-serif; background-color: #121212; color: #fff; margin: 0; }
        .header { background: #1a1a1a; padding: 20px; border-bottom: 2px solid #FF8C00; display: flex; justify-content: space-between; align-items: center; }
        .wallet-connect-btn { background: #000; color: #FF8C00; border: 2px solid #FF8C00; padding: 10px 20px; cursor: pointer; font-weight: bold; border-radius: 8px; transition: 0.3s; }
        .wallet-connect-btn:hover { background: #FF8C00; color: #000; }
        .wallet-display { background: #222; border: 1px solid #FF8C00; padding: 8px 15px; border-radius: 8px; display: flex; align-items: center; gap: 10px; }
        .section { padding: 60px 20px; text-align: center; }
        #jupiter-swap-widget { width: 100%; max-width: 420px; margin: 20px auto; }
        .notification { position: fixed; top: 20px; right: 20px; padding: 15px; border-radius: 5px; z-index: 9999; color: #fff; }
    </style>
</head>
<body>

<header class="header">
    <div class="logo"><h2 style="color:#FFD700; margin:0;">AFOX</h2></div>
    <div class="wallet-controls">
        <button id="connectWalletBtn" class="wallet-connect-btn">ü¶ä Connect Wallet</button>
        <div id="walletDisplay" class="wallet-display" style="display:none;">
            <span id="walletAddressSpan"></span>
            <button id="disconnectBtn" style="background:none; border:none; color:#e74c3c; cursor:pointer;">‚úñ</button>
        </div>
    </div>
</header>

<main>
    <section class="section">
        <h1>Aurum Fox: Web3 Ecosystem</h1>
        <p>Wallet Address: <strong id="walletAddressDisplay">Not Connected</strong></p>
        
        <div id="swap-section">
            <h3>üîÑ Instant Swap</h3>
            <div id="jupiter-swap-widget"></div>
        </div>
    </section>
</main>

<div id="notificationContainer"></div>

<script src="https://terminal.jup.ag/main-v2.js"></script>

<script>
    // --- –ù–ê–°–¢–†–û–ô–ö–ò ---
    const AFOX_MINT = 'GLkewtq8s2Yr24o5LT5mzzEeccKuSsy8H5RCHaE9uRAd';
    const SOL_MINT = 'So11111111111111111111111111111111111111112';
    let solanaWalletAdapter = null;

    // --- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ---
    function showNotification(msg, type = 'info') {
        const container = document.getElementById('notificationContainer');
        const note = document.createElement('div');
        note.className = `notification`;
        note.style.backgroundColor = type === 'success' ? '#2ecc71' : '#e74c3c';
        note.textContent = msg;
        container.appendChild(note);
        setTimeout(() => note.remove(), 4000);
    }

    // --- –õ–û–ì–ò–ö–ê –ö–û–®–ï–õ–¨–ö–ê ---
    function updateUI(adapter) {
        const btn = document.getElementById('connectWalletBtn');
        const display = document.getElementById('walletDisplay');
        const addrText = document.getElementById('walletAddressSpan');
        const debugAddr = document.getElementById('walletAddressDisplay');

        if (adapter && adapter.connected) {
            const pk = adapter.publicKey.toString();
            btn.style.display = 'none';
            display.style.display = 'flex';
            addrText.textContent = pk.substring(0, 4) + '...' + pk.slice(-4);
            debugAddr.textContent = pk;
        } else {
            btn.style.display = 'block';
            display.style.display = 'none';
            debugAddr.textContent = 'Not Connected';
        }
    }

    async function connectWallet() {
        try {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
            if (!window.solanaWalletAdapterPhantom) {
                showNotification("–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!", "error");
                return;
            }

            if (!solanaWalletAdapter) {
                solanaWalletAdapter = new window.solanaWalletAdapterPhantom.PhantomWalletAdapter();
                
                solanaWalletAdapter.on('connect', () => {
                    updateUI(solanaWalletAdapter);
                    showNotification("–ö–æ—à–µ–ª–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω", "success");
                    initJupiter(); // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –Æ–ø–∏—Ç–µ—Ä–∞ –ø—Ä–∏ –∫–æ–Ω–Ω–µ–∫—Ç–µ
                });

                solanaWalletAdapter.on('disconnect', () => {
                    updateUI(null);
                    showNotification("–ö–æ—à–µ–ª–µ–∫ –æ—Ç–∫–ª—é—á–µ–Ω");
                });
            }

            await solanaWalletAdapter.connect();
        } catch (err) {
            console.error(err);
            showNotification("–û—à–∏–±–∫–∞: " + err.message, "error");
        }
    }

    // --- JUPITER INIT ---
    function initJupiter() {
        if (window.Jupiter) {
            window.Jupiter.init({
                displayMode: 'widget',
                widgetStyle: { 'container.id': 'jupiter-swap-widget' },
                theme: 'dark',
                formProps: {
                    initialInputMint: SOL_MINT,
                    initialOutputMint: AFOX_MINT,
                }
            });
        }
    }

    // --- –ó–ê–ü–£–°–ö ---
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('connectWalletBtn').addEventListener('click', connectWallet);
        document.getElementById('disconnectBtn').addEventListener('click', () => solanaWalletAdapter.disconnect());
        
        // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –∏–Ω–∏—Ç–∏–º –Æ–ø–∏—Ç–µ—Ä
        setTimeout(initJupiter, 1000);
    });
</script>

</body>
</html>
