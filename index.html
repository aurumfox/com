<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaFox DAO - Staking & NFT Marketplace</title>
    
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://project-serum.github.io/anchor/dist/anchor.min.js"></script>
    <script src="https://unpkg.com/@solana/wallet-adapter-phantom/dist/index.iife.min.js"></script>
    
    <style>
        :root { --primary: #ff4500; --bg: #1a1a1a; --text: #ffffff; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .section { background: #2a2a2a; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-primary { background: var(--primary); color: white; }
        .btn:disabled { background: #555; cursor: not-allowed; }
        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); align-items: center; justify-content: center; z-index: 1000; }
        .modal-content { background: #333; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; position: relative; }
        .nft-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }
        .nft-card { background: #333; padding: 10px; border-radius: 8px; text-align: center; }
        .nft-card img { width: 100%; border-radius: 5px; }
        #notification-container { position: fixed; top: 20px; right: 20px; z-index: 9999; }
        .notification { padding: 15px; margin-bottom: 10px; border-radius: 5px; color: white; animation: slideIn 0.3s; }
        .notification.success { background: #28a745; }
        .notification.error { background: #dc3545; }
        .notification.info { background: #007bff; }
        #page-loader { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10000; background: rgba(0,0,0,0.5); padding: 20px; border-radius: 10px; }
        .hidden { display: none; }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
    </style>
</head>
<body>

<div id="notification-container"></div>
<div id="page-loader">ЗАГРУЗКА...</div>

<div class="container">
    <header class="section" style="display: flex; justify-content: space-between; align-items: center;">
        <h1>AlphaFox Ecosystem</h1>
        <div id="wallet-controls">
            <button class="btn btn-primary connect-wallet-btn">Connect Phantom</button>
            <div class="wallet-display" style="display: none; align-items: center; gap: 10px;">
                <span class="wallet-address-display"></span>
                <button class="btn btn-secondary copy-btn" data-copy-target="">Copy</button>
            </div>
        </div>
    </header>

    <section class="section">
        <h2>Staking AFOX</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div>
                <p>Баланс: <strong id="user-afox-balance">0 AFOX</strong></p>
                <p>В стейкинге: <strong id="user-staked-amount">0 AFOX</strong></p>
                <p>Награды: <strong id="user-rewards-amount">0 AFOX</strong></p>
                <p>APR: <span id="staking-apr">—</span></p>
                <p>Замок: <span id="lockup-period">—</span></p>
            </div>
            <div>
                <select id="pool-selector" class="btn" style="width: 100%; margin-bottom: 10px;"></select>
                <input type="number" id="stake-amount" placeholder="Количество AFOX" style="width: 100%; padding: 10px; margin-bottom: 10px;">
                <div style="display: flex; gap: 10px;">
                    <button id="stake-afox-btn" class="btn btn-primary" disabled>Stake</button>
                    <button id="claim-rewards-btn" class="btn" style="background: #28a745; color: white;" disabled>Claim</button>
                    <button id="unstake-afox-btn" class="btn" style="background: #dc3545; color: white;" disabled>Unstake</button>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <h2>Swap (Jupiter API)</h2>
        <div style="max-width: 400px;">
            <div style="display: flex; justify-content: space-between;">
                <label>From:</label>
                <span id="swap-from-balance">0 SOL</span>
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <input type="number" id="swap-from-amount" placeholder="0.0" style="flex:1; padding: 10px;">
                <select id="swap-from-token" class="btn">
                    <option value="SOL">SOL</option>
                    <option value="AFOX">AFOX</option>
                </select>
                <button class="btn max-amount-btn" data-input-id="swap-from-amount">MAX</button>
            </div>
            <button id="swap-direction-btn" style="display: block; margin: 10px auto; background: none; border: 1px solid #555; color: white; cursor: pointer;">⇅</button>
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <input type="number" id="swap-to-amount" placeholder="0.0" readonly style="flex:1; padding: 10px; background: #444;">
                <select id="swap-to-token" class="btn">
                    <option value="AFOX">AFOX</option>
                    <option value="SOL">SOL</option>
                </select>
            </div>
            <div style="font-size: 0.9em; color: #aaa; margin-bottom: 10px;">
                Price Impact: <span id="price-impact">0%</span><br>
                Fee: <span id="lp-fee">0</span><br>
                Min. Received: <span id="min-received">0</span>
            </div>
            <button id="get-quote-btn" class="btn btn-primary" style="width: 100%; margin-bottom: 5px;">Get Quote</button>
            <button id="execute-swap-btn" class="btn" style="width: 100%; background: #8c32ff; color: white; display: none;">Execute Swap</button>
        </div>
    </section>

    <section class="section">
        <h2>NFT Marketplace</h2>
        <button class="btn btn-primary" onclick="document.getElementById('mint-nft-modal').style.display='flex'">Mint New NFT</button>
        <h3>Your NFTs</h3>
        <div id="user-nft-list" class="nft-grid"></div>
        <h3>Marketplace</h3>
        <div id="marketplace-nft-list" class="nft-grid"></div>
    </section>
</div>

<div id="nft-details-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" style="position: absolute; right: 20px; cursor: pointer;">✕</span>
        <img id="nft-detail-image" src="" style="width: 100%; border-radius: 10px;">
        <h2 id="nft-detail-name"></h2>
        <p id="nft-detail-description"></p>
        <p>Owner: <span id="nft-detail-owner"></span></p>
        <p>Mint: <span id="nft-detail-mint"></span></p>
        <ul id="attributes-list"></ul>
        <div id="nft-actions">
            <button id="nft-detail-buy-btn" class="btn btn-primary" style="width: 100%; margin-top: 10px;">Buy</button>
            <button id="nft-detail-sell-btn" class="btn" style="width: 100%; margin-top: 10px; background: #ffc107;">Sell</button>
            <button id="nft-detail-transfer-btn" class="btn" style="width: 100%; margin-top: 10px; background: #6c757d;">Transfer</button>
        </div>
        <h4>History</h4>
        <ul id="nft-detail-history" style="font-size: 0.8em; max-height: 100px; overflow-y: auto;"></ul>
    </div>
</div>

<div id="mint-nft-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" style="position: absolute; right: 20px; cursor: pointer;">✕</span>
        <h2>Mint AlphaFox NFT</h2>
        <form id="mint-nft-form">
            <input type="text" name="mint-name" placeholder="Name" required style="width:100%; margin-bottom:10px; padding:8px;">
            <textarea name="mint-description" placeholder="Description" required style="width:100%; margin-bottom:10px; padding:8px;"></textarea>
            <input type="url" name="mint-image" placeholder="Image URL (optional)" style="width:100%; margin-bottom:10px; padding:8px;">
            <button type="submit" class="btn btn-primary" style="width:100%;">Mint (0.05 SOL)</button>
        </form>
    </div>
</div>

<div id="sell-nft-modal" class="modal">
    <div class="modal-content">
        <span class="close-modal" style="position: absolute; right: 20px; cursor: pointer;">✕</span>
        <h2>List NFT for Sale</h2>
        <form id="list-nft-form">
            <select id="nft-to-sell" name="nft-to-sell" style="width:100%; margin-bottom:10px; padding:8px;"></select>
            <input type="number" name="list-price" step="0.01" placeholder="Price in SOL" required style="width:100%; margin-bottom:10px; padding:8px;">
            <button type="submit" class="btn btn-primary" style="width:100%;">List Now</button>
        </form>
    </div>
</div>

<script src="script.js"></script>

</body>
</html>
