<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>AlphaFox DAO - Mobile Ready</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <style>
        body { background: #0b0b0e; color: white; font-family: sans-serif; text-align: center; padding: 20px; }
        .btn { background: #f0b90b; color: black; border: none; padding: 15px 30px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%; max-width: 300px; }
        #status { margin-top: 20px; color: #888; font-size: 14px; }
    </style>
</head>
<body>

    <h2>AlphaFox Connect</h2>
    <button id="connectBtn" class="btn">ПОДКЛЮЧИТЬ КОШЕЛЕК</button>
    <div id="status">Ожидание...</div>

<script>
    const connectBtn = document.getElementById('connectBtn');
    const status = document.getElementById('status');

    async function connect() {
        // 1. Проверяем, есть ли Phantom (внутри Phantom Browser или Kiwi)
        const isPhantomInstalled = window.solana && window.solana.isPhantom;

        if (isPhantomInstalled) {
            try {
                status.innerText = "Запрос подтверждения...";
                const resp = await window.solana.connect();
                status.innerText = "Подключено: " + resp.publicKey.toString().substring(0, 6) + "...";
                connectBtn.innerText = "ГОТОВО";
                connectBtn.style.background = "#0ecb81";
            } catch (err) {
                status.innerText = "Отказ: " + err.message;
            }
        } else {
            // 2. ЕСЛИ КОШЕЛЬКА НЕТ (как у тебя сейчас в Chrome на Android)
            status.innerText = "Кошелек не найден. Перенаправление...";
            
            // Получаем текущую ссылку на твой сайт
            const currentUrl = window.location.href;
            
            // Создаем Deep Link (глубокую ссылку) для открытия в приложении Phantom
            // Если приложения нет, ссылка сама предложит Play Market
            const phantomLink = `https://phantom.app/ul/browse/${encodeURIComponent(currentUrl)}?ref=${encodeURIComponent(currentUrl)}`;
            
            // Перекидываем пользователя
            window.location.href = phantomLink;
        }
    }

    connectBtn.onclick = connect;
</script>
</body>
</html>
