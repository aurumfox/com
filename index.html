<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaFox DAO Terminal</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/buffer/6.0.3/buffer.min.js"></script>
    <script>window.Buffer = window.buffer.Buffer;</script>
    <script src="https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/@project-serum/anchor@0.26.0/dist/browser.anchor.min.js"></script>

    <style>
        :root { --gold: #f0b90b; --bg: #0b0b0e; --card: rgba(255,255,255,0.05); }
        body { background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        
        /* –°—Ç–∏–ª–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ —Å–µ–∫—Ü–∏–π */
        .section { margin-bottom: 40px; padding: 20px; border-radius: 20px; background: var(--card); border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(10px); }
        .web3-heading { color: var(--gold); border-bottom: 1px solid var(--gold); padding-bottom: 10px; margin-bottom: 20px; }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .btn, .web3-btn { background: var(--gold); color: #000; border: none; padding: 12px 20px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; margin: 5px 0; transition: 0.3s; }
        .btn:disabled, .web3-btn:disabled { background: #444; color: #888; }
        .btn:hover { opacity: 0.8; }

        /* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
        input, select, textarea { background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); color: #fff; padding: 12px; border-radius: 8px; width: 100%; box-sizing: border-box; margin: 10px 0; }
        
        /* –°–µ—Ç–∫–∏ */
        .web3-features-grid, .content-area { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .feature-card { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 15px; text-align: center; border: 1px solid rgba(255,255,255,0.05); }
        .feature-card h3 { color: var(--gold); font-size: 1rem; }
        .web3-link { color: var(--gold); text-decoration: none; font-size: 0.9rem; font-weight: bold; }

        .staking-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .info-card { background: rgba(0,0,0,0.2); padding: 10px; border-radius: 10px; text-align: center; }
        .info-value { color: var(--gold); font-weight: bold; font-size: 1.1rem; margin: 5px 0; }

        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal-content { background: #1a1a1d; padding: 30px; border-radius: 20px; width: 90%; max-width: 500px; border: 1px solid var(--gold); }
    </style>
</head>
<body>

<div class="container">
    <header style="text-align: center; padding: 30px 0;">
        <h1 style="color: var(--gold); margin: 0; font-size: 2.5rem;">AlphaFox <span style="font-weight: 100;">DAO</span></h1>
        <div class="section" style="margin-top: 20px;">
            <p id="wallet-display">Wallet: <strong>Not Connected</strong></p>
            <button id="connectBtn" class="btn">CONNECT PHANTOM WALLET</button>
        </div>
    </header>

    <section id="web3-site-home" class="section">
        <h2 class="web3-heading">üéÆ My Web3 Portal</h2>
        <div class="web3-features-grid">
            <div class="feature-card"><h3>üéÆ Games</h3><a href="#games-section" class="web3-link">Explore</a></div>
            <div class="feature-card"><h3>üñºÔ∏è NFTs</h3><a href="#nft-section" class="web3-link">Manage</a></div>
            <div class="feature-card"><h3>üèõÔ∏è DAO</h3><a href="#dao-section" class="web3-link">Vote</a></div>
            <div class="feature-card"><h3>üí∞ Staking</h3><a href="#staking-section" class="web3-link">Earn</a></div>
            <div class="feature-card"><h3>üîÑ Swap</h3><a href="#swap-section" class="web3-link">Exchange</a></div>
        </div>
    </section>

    <section id="staking-section" class="section">
        <h2 class="web3-heading">üí∞ AFOX Staking</h2>
        <div class="staking-info-grid">
            <div class="info-card"><h3>Balance</h3><p id="user-afox-balance" class="info-value">0 AFOX</p></div>
            <div class="info-card"><h3>Staked</h3><p id="user-staked-amount" class="info-value">0 AFOX</p></div>
            <div class="info-card"><h3>Rewards</h3><p id="user-rewards-amount" class="info-value">0 AFOX</p></div>
            <div class="info-card"><h3>APR</h3><p id="staking-apr" class="info-value">12%</p></div>
        </div>
        <input type="number" id="stake-amount" placeholder="Amount to stake">
        <button id="stake-afox-btn" class="web3-btn" disabled>STAKE NOW</button>
        <button id="claim-rewards-btn" class="web3-btn" style="background:none; color:var(--gold); border:1px solid var(--gold);" disabled>CLAIM REWARDS</button>
    </section>

    <section id="swap-section" class="section">
        <h2 class="web3-heading">üîÑ Jupiter Swap</h2>
        <p style="font-size: 0.8rem; color: #888;">Pay SOL:</p>
        <input type="number" id="swap-from-amount" placeholder="0.1">
        <p style="font-size: 0.8rem; color: #888;">Receive AFOX (est): <span id="swap-estimate" style="color:var(--gold)">0.00</span></p>
        <button id="execute-swap-btn" class="web3-btn" disabled>EXCHANGE VIA JUPITER</button>
    </section>

    <section id="nft-section" class="section">
        <h2 class="web3-heading">üñºÔ∏è NFT Collections</h2>
        <div class="nft-actions" style="display:flex; gap:10px;">
            <button id="viewMyNftsBtn" class="web3-btn">View My NFTs</button>
            <button id="mintNftBtn" class="web3-btn" onclick="document.getElementById('mint-modal').style.display='flex'">Mint New</button>
        </div>
        <div id="user-nft-list" class="content-area"><p>Connect wallet to see NFTs...</p></div>
    </section>

    <section id="dao-section" class="section">
        <h2 class="web3-heading">üèõÔ∏è DAO Governance</h2>
        <button id="createProposalBtn" class="web3-btn">Create Proposal</button>
        <div id="active-proposals-list" class="content-area">
            <div class="feature-card">
                <h4>Proposal #1: Community Fund</h4>
                <p>Votes: 150 AFOX</p>
                <button class="web3-btn" style="padding:5px; font-size:12px;">Vote For</button>
            </div>
        </div>
    </section>
</div>

<div id="mint-modal" class="modal">
    <div class="modal-content">
        <h2 style="color:var(--gold)">Mint Your NFT</h2>
        <input type="text" id="mintNftName" placeholder="NFT Name">
        <textarea id="mintNftDescription" placeholder="Description"></textarea>
        <input type="file" id="nftFile">
        <button class="web3-btn" onclick="alert('Minting process started...')">MINT (0.05 SOL)</button>
        <button class="web3-btn" style="background:#333; color:#fff;" onclick="this.parentElement.parentElement.style.display='none'">Close</button>
    </div>
</div>

<script>
/**
 * –õ–û–ì–ò–ö–ê –ò –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
 */
const PROGRAM_ID = "–¢–í–û–ô_ID_–ü–†–û–ì–†–ê–ú–ú–´"; 
const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com", "confirmed");
let provider = null;

async function handleConnect() {
    if (window.solana && window.solana.isPhantom) {
        try {
            const resp = await window.solana.connect();
            onWalletConnected(resp.publicKey.toString());
        } catch (err) { console.error(err); }
    } else {
        window.location.href = `https://phantom.app/ul/browse/${encodeURIComponent(window.location.href)}`;
    }
}

function onWalletConnected(pubKey) {
    document.getElementById('wallet-display').innerHTML = `Connected: <span style="color:var(--gold)">${pubKey.substring(0,6)}...${pubKey.slice(-4)}</span>`;
    document.getElementById('connectBtn').style.display = 'none';
    
    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫
    document.querySelectorAll('button:disabled').forEach(btn => btn.disabled = false);
    
    provider = new anchor.AnchorProvider(connection, window.solana, { preflightCommitment: "confirmed" });
}

async function stakeTokens() {
    const amount = document.getElementById('stake-amount').value;
    if (!amount) return alert("–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É");
    alert(`–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å—Ç–µ–π–∫–∏–Ω–≥–∞ –Ω–∞ ${amount} AFOX –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∞!`);
}

async function executeSwap() {
    const solAmount = document.getElementById('swap-from-amount').value;
    try {
        const quote = await fetch(`https://quote-api.jup.ag/v6/quote?inputMint=So11111111111111111111111111111111111111112&outputMint=AFOX_MINT_ADDRESS&amount=${solAmount * 1e9}&slippageBps=50`).then(res => res.json());
        document.getElementById('swap-estimate').innerText = (quote.outAmount / 1e9).toFixed(2);
        alert("–ö–æ—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—É—á–µ–Ω–∞. –ü–æ–¥–ø–∏—à–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –∫–æ—à–µ–ª—å–∫–µ.");
    } catch (e) { alert("–û—à–∏–±–∫–∞ Swap: " + e.message); }
}

// –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π
document.getElementById('connectBtn').onclick = handleConnect;
document.getElementById('stake-afox-btn').onclick = stakeTokens;
document.getElementById('execute-swap-btn').onclick = executeSwap;

window.onload = () => {
    if (window.solana && window.solana.isPhantom && window.solana.isConnected) {
        window.solana.connect({ onlyIfTrusted: true }).then(r => onWalletConnected(r.publicKey.toString()));
    }
};
</script>

</body>
</html>
