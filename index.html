<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaFox DAO & Multimedia Terminal</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/buffer/6.0.3/buffer.min.js"></script>
    <script>window.Buffer = window.buffer.Buffer;</script>
    <script src="https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/@project-serum/anchor@0.26.0/dist/browser.anchor.min.js"></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <style>
        :root { 
            --gold: #f0b90b; 
            --bg: #0b0b0e; 
            --card: rgba(255,255,255,0.05); 
            --text: #ffffff;
        }
        body { 
            background: var(--bg); 
            color: var(--text); 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            margin: 0; 
            line-height: 1.6;
        }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
        
        /* –°—Ç–∏–ª–∏ –∫–∞—Ä—Ç–æ—á–µ–∫ */
        .glass-card { 
            background: var(--card); 
            border: 1px solid rgba(255,255,255,0.1); 
            border-radius: 20px; 
            padding: 25px; 
            margin-bottom: 20px; 
            backdrop-filter: blur(10px); 
        }
        
        h1, h2, h3 { color: var(--gold); }
        .btn { 
            background: var(--gold); 
            color: #000; 
            border: none; 
            padding: 12px 20px; 
            border-radius: 10px; 
            font-weight: bold; 
            cursor: pointer; 
            width: 100%; 
            transition: 0.3s;
        }
        .btn:disabled { background: #444; color: #888; cursor: not-allowed; }
        
        input, textarea { 
            background: rgba(0,0,0,0.3); 
            border: 1px solid rgba(255,255,255,0.1); 
            color: #fff; 
            padding: 12px; 
            border-radius: 8px; 
            width: 100%; 
            box-sizing: border-box; 
            margin: 10px 0; 
        }

        .nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--card);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .stat-item { background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; }
        .val { color: var(--gold); font-weight: bold; display: block; font-size: 1.2rem; }
        
        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã */
        table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        th, td { padding: 10px; border: 1px solid rgba(255,255,255,0.1); text-align: left; }
        th { color: var(--gold); }
    </style>
</head>
<body>
<div class="container">
    <header class="nav-header">
        <h1 style="margin:0;">AlphaFox <span style="font-weight:100;">DAO</span></h1>
        <div>
            <span id="wallet-display" style="font-size: 12px; color: #888; margin-right:10px;">Not Connected</span>
            <button id="connectBtn" class="btn" style="width:auto;">CONNECT WALLET</button>
        </div>
    </header>

    <section class="glass-card">
        <h2>ü¶ä Tokenomics & Security</h2>
        <div class="stats-grid">
            <div class="stat-item">Supply: <span class="val">10,000,000 AFOX</span></div>
            <div class="stat-item">Rights: <span class="val">Revoked ‚úÖ</span></div>
        </div>
        <p style="font-size: 0.9rem; color: #aaa;">Contract: <code style="color:var(--gold)">GLkewtq8s2Yr24o5LT5mzzEeccKuSsy8H5RCHaE9uRAd</code></p>
    </section>

    <section class="glass-card">
        <h2>üí∞ Staking Portal</h2>
        <div class="stats-grid">
            <div class="stat-item">Balance: <span id="user-afox-balance" class="val">0 AFOX</span></div>
            <div class="stat-item">Staked: <span id="user-staked-amount" class="val">0 AFOX</span></div>
            <div class="stat-item">Rewards: <span id="user-rewards" class="val">0 AFOX</span></div>
        </div>
        <input type="number" id="stake-amount" placeholder="Amount to stake">
        <button id="stake-afox-btn" class="btn" disabled>STAKE NOW</button>
        <button id="claim-rewards-btn" class="btn" style="background:none; color:var(--gold); border:1px solid var(--gold); margin-top:10px;" disabled>CLAIM REWARDS</button>
    </section>

    <section class="glass-card">
        <h2>üó∫Ô∏è Roadmap Highlights</h2>
        <ul>
            <li><b>Phase 1:</b> Token Launch & LP Revoke (Done)</li>
            <li><b>Phase 2:</b> Marketing & Community Growth</li>
            <li><b>Phase 3:</b> DAO Governance & NFT Integration</li>
        </ul>
    </section>
</div>
<script>
// –ù–∞—Å—Ç—Ä–æ–π–∫–∏
const AFOX_MINT = "GLkewtq8s2Yr24o5LT5mzzEeccKuSsy8H5RCHaE9uRAd";
const connection = new solanaWeb3.Connection("https://api.mainnet-beta.solana.com", "confirmed");
let provider = null;

// Firebase (–≤—Å—Ç–∞–≤—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞)
const firebaseConfig = {
    apiKey: "–¢–í–û–ô_–ö–õ–Æ–ß",
    projectId: "aurum-fox",
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï (–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è)
async function handleConnect() {
    const isPhantomInstalled = window.solana && window.solana.isPhantom;

    if (isPhantomInstalled) {
        try {
            const resp = await window.solana.connect();
            onWalletConnected(resp.publicKey.toString());
        } catch (err) {
            console.error("Connection error", err);
        }
    } else {
        // –°—Å—ã–ª–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–∞–π—Ç –≤–Ω—É—Ç—Ä–∏ Phantom)
        const currentUrl = window.location.href;
        window.location.href = `https://phantom.app/ul/browse/${encodeURIComponent(currentUrl)}?ref=${encodeURIComponent(currentUrl)}`;
    }
}

function onWalletConnected(pubKey) {
    document.getElementById('wallet-display').innerText = pubKey.substring(0, 4) + "..." + pubKey.slice(-4);
    document.getElementById('connectBtn').innerText = "CONNECTED ‚úÖ";
    document.getElementById('connectBtn').disabled = true;

    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏
    document.querySelectorAll('.btn').forEach(b => b.disabled = false);

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Anchor
    provider = new anchor.AnchorProvider(connection, window.solana, { preflightCommitment: "confirmed" });
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    loadUserData(pubKey);
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑ Firebase (–∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–º –∫–æ–¥–µ)
function loadNews() {
    db.collection('news').orderBy('timestamp', 'desc').limit(3).get().then(snap => {
        // –õ–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π
    });
}

// –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π
document.getElementById('connectBtn').onclick = handleConnect;
window.onload = () => {
    if (window.solana && window.solana.isPhantom) {
        window.solana.connect({ onlyIfTrusted: true })
            .then(resp => onWalletConnected(resp.publicKey.toString()))
            .catch(() => console.log("Manual connect required"));
    }
};
</script>
