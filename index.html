<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>AlphaFox Check</title>
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <style>
        body { background: #111; color: #fff; font-family: sans-serif; text-align: center; padding-top: 50px; }
        .box { border: 1px solid #333; padding: 20px; display: inline-block; border-radius: 10px; background: #1a1a1a; }
        button { background: #f0b90b; padding: 15px 30px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        #log { margin-top: 20px; color: #888; font-size: 12px; }
    </style>
</head>
<body>

<div class="box">
    <h2>AlphaFox Connection Test</h2>
    <p id="helper">Проверка расширения...</p>
    <button id="btn">СПОДКЛЮЧИТЬ PHANTOM</button>
    <div id="log"></div>
</div>

<script>
    const log = (msg) => { document.getElementById('log').innerHTML += msg + "<br>"; };
    const btn = document.getElementById('btn');

    // 1. Проверка при загрузке
    window.onload = () => {
        if (window.solana) {
            document.getElementById('helper').innerText = "✅ Phantom обнаружен";
            log("Система готова к подключению.");
        } else {
            document.getElementById('helper').innerText = "❌ Phantom НЕ НАЙДЕН";
            log("Установите расширение Phantom или убедитесь, что вы открыли сайт через http://, а не file://");
        }
    };

    // 2. Логика кнопки
    btn.onclick = async () => {
        log("Нажатие зафиксировано...");
        try {
            if (!window.solana) throw new Error("Кошелек не найден в окне браузера");
            
            log("Запрос к Phantom...");
            const resp = await window.solana.connect();
            
            log("УСПЕХ! Адрес: " + resp.publicKey.toString());
            btn.innerText = "ПОДКЛЮЧЕНО";
            btn.style.background = "#0ecb81";
        } catch (err) {
            log("ОШИБКА: " + err.message);
            console.error(err);
        }
    };
</script>
</body>
</html>
