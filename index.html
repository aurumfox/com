<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaFox DAO | Staking & NFT Marketplace</title>
    
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://unpkg.com/@project-serum/anchor@latest/dist/browser.anchor.min.js"></script>
    <script src="https://bundle.run/@solana/wallet-adapter-phantom@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/buffer/6.0.3/buffer.min.js"></script>

    <style>
        :root {
            --bg-color: #0b0e11;
            --card-bg: #1e2329;
            --primary: #f0b90b;
            --text: #eaeaea;
            --danger: #f6465d;
            --success: #0ecb81;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text);
            margin: 0;
            padding: 0;
        }

        header {
            background: var(--card-bg);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        h2 { color: var(--primary); margin-top: 0; }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        input, select, button {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
            border: 1px solid #444;
            background: #2b3139;
            color: white;
            box-sizing: border-box;
        }

        button {
            background: var(--primary);
            color: black;
            font-weight: bold;
            cursor: pointer;
            border: none;
            transition: opacity 0.2s;
        }

        button:disabled { opacity: 0.5; cursor: not-allowed; }

        .connected-info {
            font-size: 0.9rem;
            background: #2b3139;
            padding: 5px 10px;
            border-radius: 4px;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        #notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .notification {
            padding: 15px 25px;
            margin-bottom: 10px;
            border-radius: 8px;
            color: white;
            animation: slideIn 0.3s ease-out;
        }
        .notification.success { background: var(--success); }
        .notification.error { background: var(--danger); }
        .notification.info { background: #333; }

        /* Loader */
        #page-loader {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .nft-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
        }

        .nft-card {
            background: #2b3139;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .nft-card img { max-width: 100%; border-radius: 4px; }

        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }

        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div id="page-loader">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
<div id="notification-container"></div>

<header>
    <div class="logo"><strong>AlphaFox Portal</strong></div>
    <div id="wallet-controls">
        <button class="connect-wallet-btn" style="width: auto;">Connect Phantom</button>
        <div class="wallet-display" style="display: none; align-items: center; gap: 10px;">
            <span class="wallet-address-display connected-info"></span>
            <button onclick="disconnectWallet()" style="width: auto; padding: 5px 10px; background: #444; color: white;">Exit</button>
        </div>
    </div>
</header>

<div class="container">
    <div class="grid">
        
        <div class="card">
            <h2>ü¶ä AFOX Staking</h2>
            <div style="margin-bottom: 1rem;">
                –ë–∞–ª–∞–Ω—Å: <span id="user-afox-balance">0 AFOX</span><br>
                –í —Å—Ç–µ–π–∫–µ: <span id="user-staked-amount">0 AFOX</span><br>
                –ù–∞–≥—Ä–∞–¥—ã: <span id="user-rewards-amount">0 AFOX</span>
            </div>
            
            <label>–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–ª:</label>
            <select id="pool-selector"></select>
            
            <input type="number" id="stake-amount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ AFOX">
            <button id="stake-afox-btn">Stake AFOX</button>
            <hr style="border-color: #333;">
            <button id="claim-rewards-btn">Claim Rewards</button>
            <button id="unstake-afox-btn" style="background: var(--danger); color: white;">Unstake</button>
            
            <p style="font-size: 0.8rem; color: #888;">
                –ü–µ—Ä–∏–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: <span id="lockup-period">‚Äî</span><br>
                –¢–µ–∫—É—â–∞—è —Å—Ç–∞–≤–∫–∞: <span id="staking-apr">‚Äî</span>
            </p>
        </div>

        <div class="card">
            <h2>üîÑ Quick Swap</h2>
            <div class="swap-container">
                <label>From:</label>
                <div style="display: flex; gap: 5px;">
                    <select id="swap-from-token">
                        <option value="SOL">SOL</option>
                        <option value="AFOX">AFOX</option>
                    </select>
                    <input type="number" id="swap-from-amount" placeholder="0.0">
                </div>
                <div style="font-size: 0.8rem; text-align: right;">
                    –ë–∞–ª–∞–Ω—Å: <span id="swap-from-balance">0</span> 
                    <button class="max-amount-btn" data-input-id="swap-from-amount" style="width: auto; padding: 2px 5px; font-size: 0.7rem;">MAX</button>
                </div>

                <div style="text-align: center; margin: 5px 0;">‚¨áÔ∏è</div>

                <label>To:</label>
                <div style="display: flex; gap: 5px;">
                    <select id="swap-to-token">
                        <option value="AFOX">AFOX</option>
                        <option value="SOL">SOL</option>
                    </select>
                    <input type="number" id="swap-to-amount" readonly placeholder="0.0">
                </div>

                <div id="quote-info" style="font-size: 0.8rem; margin-top: 10px; color: #888;">
                    Price Impact: <span id="price-impact">0%</span> | Fee: <span id="lp-fee">0</span>
                </div>
                
                <button id="get-quote-btn" style="background: #444; color: white;">–û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—É</button>
                <button id="execute-swap-btn" style="display: none;">Execute Swap</button>
            </div>
        </div>

        <div class="card" style="grid-column: span 1;">
            <h2>üñº My NFTs</h2>
            <div id="user-nft-list" class="nft-grid">
                <p>–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫...</p>
            </div>
        </div>

        <div class="card" style="grid-column: span 1;">
            <h2>üõí Marketplace</h2>
            <div id="marketplace-nft-list" class="nft-grid"></div>
        </div>

    </div>
</div>

<div id="nft-details-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1001; justify-content: center; align-items: center;">
    <div class="card" style="max-width: 400px; width: 90%;">
        <img id="nft-detail-image" src="" style="width: 100%; border-radius: 8px;">
        <h3 id="nft-detail-name"></h3>
        <p id="nft-detail-description" style="font-size: 0.9rem;"></p>
        <p>Owner: <span id="nft-detail-owner" style="font-size: 0.7rem;"></span></p>
        <button id="nft-detail-buy-btn" style="display: none;">Buy</button>
        <button id="nft-detail-sell-btn" style="display: none;">List/Unlist</button>
        <button id="nft-detail-transfer-btn" style="display: none;">Transfer</button>
        <button onclick="closeAllPopups()" style="background: #444; color: white;">Close</button>
    </div>
</div>

<script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Buffer –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ Solana –≤ –±—Ä–∞—É–∑–µ—Ä–µ
    window.Buffer = window.buffer.Buffer;

    // –í–°–¢–ê–í–¨–¢–ï –í–ê–® JAVASCRIPT –ö–û–î –ù–ò–ñ–ï
    // (–ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –ø—Ä–∏—Å–ª–∞–ª–∏, –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å—é–¥–∞)
</script>

<script>
    // –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—é–¥–∞ –≤–∞—à JS-–∫–æ–¥ (–Ω–∞—á–∏–Ω–∞—è —Å const STAKING_IDL –∏ –¥–æ –∫–æ–Ω—Ü–∞)
    // –Ø —É–∂–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–ª —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –≤ HTML –ø–æ–¥ –≤–∞—à —Å–∫—Ä–∏–ø—Ç.
</script>

</body>
</html>
