<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaFox DAO - Staking & NFT Marketplace</title>
    
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/buffer/6.0.3/buffer.min.js"></script>
    <script src="https://unpkg.com/@project-serum/anchor@latest/dist/browser/anchor.min.js"></script>

    <style>
        :root {
            --primary: #ff4500;
            --bg: #0f111a;
            --card-bg: #1a1c26;
            --text: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Навигация и Мобильное меню */
        header {
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0,0,0,0.5);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .main-nav {
            display: flex;
            gap: 20px;
        }

        .main-nav.is-open {
            display: flex !important;
            flex-direction: column;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg);
            padding: 50px;
        }

        .nav-mobile-overlay.active {
            display: block;
        }

        /* Сетки контента */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid #333;
        }

        /* Кнопки */
        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn:disabled { background: #555; }

        /* Уведомления */
        #notification-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9999;
        }

        .notification {
            background: #333;
            padding: 15px;
            margin-top: 10px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            animation: slideIn 0.5s ease;
        }

        /* Модальные окна */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        /* Специфические стили для мобильных */
        @media (max-width: 768px) {
            .main-nav { display: none; }
            header { padding: 10px; }
        }

        #page-loader {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>

    <div id="page-loader">Загрузка...</div>

    <header>
        <div class="logo">AlphaFox DAO</div>
        <button id="menuToggle" class="btn" style="width: auto;">Меню</button>
        <nav id="mainNav" class="main-nav">
            <a href="#staking" style="color: white;">Стейкинг</a>
            <a href="#swap" style="color: white;">Обмен</a>
            <a href="#nft" style="color: white;">NFT</a>
            <button id="closeMainMenuCross" class="btn" style="width: auto;">✕</button>
        </nav>
        <div class="wallet-controls">
            <button class="connect-wallet-btn btn" style="width: auto;">Connect Wallet</button>
            <div class="wallet-display" style="display:none; align-items: center; gap: 10px;">
                <span class="wallet-address-display"></span>
                <button class="btn disconnect-btn" style="width: auto; background: #333;">✕</button>
            </div>
        </div>
    </header>

    <div class="container">
        <section id="balances" class="card" style="margin-bottom: 20px;">
            <h2>Ваш кошелек</h2>
            <p>Баланс AFOX: <span id="user-afox-balance">0 AFOX</span></p>
            <p>Адрес: <span id="walletAddressDisplay">Не подключен</span> 
                <button class="copy-btn btn" style="width: auto; padding: 5px;" data-copy-target="">Копировать</button>
            </p>
        </section>

        <div class="grid">
            <section id="staking" class="card">
                <h2>Стейкинг AFOX</h2>
                <div class="staking-info">
                    <p>В стейке: <span id="user-staked-amount">0 AFOX</span></p>
                    <p>Награды: <span id="user-rewards-amount">0 AFOX</span></p>
                    <p>APR: <span id="staking-apr">—</span></p>
                    <p>Замок: <span id="lockup-period">—</span></p>
                </div>
                <select id="pool-selector" class="btn" style="background: #222; margin-bottom: 10px;"></select>
                <input type="number" id="stake-amount" placeholder="Количество AFOX" style="width: 90%; padding: 10px; margin-bottom: 10px;">
                <button id="stake-afox-btn" class="btn">Застейкать</button>
                <button id="claim-rewards-btn" class="btn" style="margin-top: 10px; background: green;">Забрать награды</button>
                <button id="unstake-afox-btn" class="btn" style="margin-top: 10px; background: #666;">Вывести из стейка</button>
            </section>

            <section id="swap" class="card">
                <h2>Jupiter Swap</h2>
                <div class="swap-box">
                    <label>Отдаете:</label>
                    <select id="swap-from-token" class="btn" style="background: #222;">
                        <option value="SOL">SOL</option>
                        <option value="AFOX">AFOX</option>
                    </select>
                    <input type="number" id="swap-from-amount" placeholder="0.0">
                    <button class="max-amount-btn" data-input-id="swap-from-amount">MAX</button>
                    <p>Баланс: <span id="swap-from-balance">0</span></p>
                    
                    <button id="swap-direction-btn" class="btn" style="background:transparent; font-size: 20px;">⇅</button>
                    
                    <label>Получаете:</label>
                    <select id="swap-to-token" class="btn" style="background: #222;">
                        <option value="AFOX">AFOX</option>
                        <option value="SOL">SOL</option>
                    </select>
                    <input type="number" id="swap-to-amount" readonly>
                    
                    <div class="swap-details" style="font-size: 12px; margin-top: 10px;">
                        <p>Impact: <span id="price-impact">0%</span></p>
                        <p>Fee: <span id="lp-fee">0</span></p>
                        <p>Min. Received: <span id="min-received">0</span></p>
                    </div>
                    <button id="get-quote-btn" class="btn">Рассчитать</button>
                    <button id="execute-swap-btn" class="btn" style="display:none; background: linear-gradient(to right, #f7931a, #ff4500);">Обменять</button>
                </div>
            </section>
        </div>

        <section id="nft" style="margin-top: 40px;">
            <h2>NFT Маркетплейс</h2>
            <div class="grid">
                <div class="card">
                    <h3>Ваши NFT</h3>
                    <div id="user-nft-list" class="nft-container"></div>
                    <button class="btn" onclick="document.getElementById('mint-nft-modal').style.display='flex'">Минт новой NFT</button>
                </div>
                <div class="card">
                    <h3>Витрина (Продажа)</h3>
                    <div id="marketplace-nft-list" class="nft-container"></div>
                </div>
            </div>
        </section>

        <section id="dao" class="card" style="margin-top: 20px;">
            <h2>Управление DAO</h2>
            <button id="createProposalBtn" class="btn">Создать предложение</button>
        </section>
    </div>

    <div id="nft-details-modal" class="modal">
        <div class="card" style="max-width: 400px;">
            <img id="nft-detail-image" src="" style="width: 100%; border-radius: 10px;">
            <h3 id="nft-detail-name"></h3>
            <p id="nft-detail-description"></p>
            <p>Владелец: <span id="nft-detail-owner"></span></p>
            <p>Минт: <span id="nft-detail-mint"></span></p>
            <ul id="attributes-list"></ul>
            <button id="nft-detail-buy-btn" class="btn">Купить</button>
            <button id="nft-detail-sell-btn" class="btn">Выставить на продажу</button>
            <button id="nft-detail-transfer-btn" class="btn">Передать</button>
            <button class="btn close-modal" style="margin-top:10px; background: #333;">Закрыть</button>
        </div>
    </div>

    <div id="mint-nft-modal" class="modal">
        <form id="mint-nft-form" class="card">
            <h3>Создать NFT</h3>
            <input name="mint-name" placeholder="Название" required class="btn" style="background: #222; text-align: left; margin-bottom:10px;">
            <textarea name="mint-description" placeholder="Описание" class="btn" style="background: #222; text-align: left; margin-bottom:10px;"></textarea>
            <input name="mint-image" placeholder="Ссылка на картинку" class="btn" style="background: #222; text-align: left; margin-bottom:10px;">
            <button type="submit" class="btn">Создать (0.05 SOL)</button>
            <button type="button" class="btn close-modal" style="margin-top:10px; background: #333;">Отмена</button>
        </form>
    </div>

    <div id="notification-container"></div>
    <div class="nav-mobile-overlay"></div>

    <script src="script.js"></script>
</body>
</html>
